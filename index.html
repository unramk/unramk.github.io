<style>
    .floater-position {
        position: fixed;
        right: 2vmin;
        bottom: 2vmin;
    }

    .floater-mini {
        width: 15vmin;
        height: 15vmin;
    }

    .floater-full {
        display: none;
        width: 45vmin;
        height: 80vmin;
        font-size: 0.45vmin;
    }

    .floater-mini-style {
        border:1vmin solid #008080;
        border-radius: 100%;
        overflow: hidden;
    }

    .floater-full-style {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        border-radius: 3vmin;
        overflow: hidden;
    }

    .floater-vid-mini {
        object-fit: cover;
        object-position: center;
        width: 100%;
        height: 100%;
    }

    .floater-vid-full {
        object-fit: cover;
        object-position: center;
        width: 100%;
        height: 100%;
    }

    .cancel-img {
        position: absolute;
        right: -1vmin;
        top: -1vmin;
        z-index: 5;
        width: 4vmin;
        height: 4vmin;
    }

    .overlay-blob {
        width: 24em;
        height: 24em;
        border-radius: 3vmin;
        bottom: 7%;
        background-color: #008080;
        z-index: 1;
        position: absolute;
        text-align: center;
    }

    .blob-1-3 { left: 9%; }
    .blob-2-3 { left: 38%; }
    .blob-3-3 { left: 67%; }
    .blob-1-2 { left: 20%; }
    .blob-2-2 { left: 56%; }

    .blob-img {
        width: 35%;
        margin-top: 15%;
        object-fit: contain;
    }

    .blob-text {
        position: absolute;
        margin-left: auto;
        margin-right: auto;
        width: 100%;
        bottom: 15%;
        font-family: helvetica;
        font-size: 3em;
        color: white;
    }

    .play-img {
        position: absolute;
        top: 0; left: 0; bottom: 0; right: 0;
        margin-left: auto;
        margin-right: auto;
        margin-top: auto;
        margin-bottom: auto;
        z-index: 1;
        width: 7vmin;
        height: 7vmin;
        display: none;
    }

    .video-freeze {
        position: absolute;
        top: 0;
        left: 0;
        display: none;
        width: 100%;
        height: 100%;
        background-color: black;
        opacity: 0.2;
    }

    .progress-slider {
        overflow: hidden;
        outline: none;
        appearance: none;
        background-color: rgba(0, 0, 0, 0.5);
        position: absolute;
        bottom: -2px;
        left: -2px;
        width: 100%;
        height: 2em;
        cursor: pointer;
        z-index: 2;
    }

    .progress-slider::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        width: 0.001px;
        height: 0.001px;
        margin-top: 8000px;
        box-shadow: -10000px 0 0 10000px #008080;
    }

    .message-overlay {
        display: none;
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 3;
        background-color: white;
    }

    .form-content {
        font-size: 5em;
        text-align: center;
    }

    .form-row {
        display: inline-block;
        vertical-align: center;
        width: 100%;
        height: 5em;
    }

    @media screen and (max-device-width:660px), screen and (max-width:660px) {
        .floater-mini {
            width: 25vmin!important;
            height: 25vmin!important;
        }
        .cancel-img {
            width: 8vmin;
            height: 8vmin;
        }
        .play-img {
            width: 14vmin;
            height: 14vmin;
        }
        .blob-text {
            font-size: 5em;
        }
    }

    @media screen and (max-device-width:660px) and (orientation: landscape), screen and (max-width:660px) and (orientation: landscape) {
        .floater-full {
            width: 90vh;
            height: 90vh;
            font-size: 0.90vmin;
        }
    }

    @media screen and (max-device-width:660px) and (orientation: portrait), screen and (max-width:660px) and (orientation: portrait) {
        .floater-full {
            width: 45vh;
            height: 80vh;
            font-size: 0.45vmin;
        }
        .floater-full {
            width: min(54vh, 96vw);
            height: min(96vh, 170.666vw);
            font-size: min(0.54vh, 0.96vw);
        }
    }

</style>
<img class="play-btn" src="https://viyoubotstorage.blob.core.windows.net/viyoubot-misc-imgs/play.png">

<div id="mini-floater" class="floater-position floater-mini floater-mini-style" onclick="miniClick()">
        <video class="floater-vid-mini" autoplay loop muted>
            <source src="https://viyoubotstorage.blob.core.windows.net/asset-cb0659e9-db62-4b3f-8635-3cc281dd4cd7/alvaro-cut.mp4" type="video/mp4">
        </video>
</div>

<div id="full-floater" class="floater-position floater-full">
    <img class="cancel-img" src="https://viyoubotstorage.blob.core.windows.net/viyoubot-misc-imgs/cancel.png" onclick="cancelClick()">
    <div id="full-style" class="floater-full-style">
        <video id="floater-video" class="floater-vid-full" onclick="videoClick()">
            <source src="https://viyoubotstorage.blob.core.windows.net/asset-146786da-01ee-4c9d-878c-317f3298fb15/alvaro.mp4" type="video/mp4">
        </video>
        <div class="overlay-blob blob-1-2" onclick="callPhone()">
            <img class="blob-img" src="https://viyoubotstorage.blob.core.windows.net/viyoubot-misc-imgs/phonew.png">
            <div class="blob-text">CALL</div>
        </div>
        <div class="overlay-blob blob-2-2" onclick="openMsgForm()">
            <img class="blob-img" src="https://viyoubotstorage.blob.core.windows.net/viyoubot-misc-imgs/chatw.png">
            <div class="blob-text">TEXT</div>
        </div>
        <input id="slider-prog" type="range" min="0" max="1000" value="500" class="progress-slider">
        <div id="freeze" class="video-freeze" onclick="videoClick()"></div>
        <img id="play" class="play-img" onclick="videoClick()" src="https://viyoubotstorage.blob.core.windows.net/viyoubot-misc-imgs/play.png">
        <div id="message-form" class="message-overlay">
            <div class="form-content">
                <div class="form-row">Your Email</div>
                <input type="text" class="form-row">
                <div class="form-row">Your Message</div>
                <input type="text" class="form-row">
            </div>
        </div>
    </div>
</div>

<script>
    var mini = document.getElementById("mini-floater");
    var full = document.getElementById("full-floater");
    var vid = document.getElementById("floater-video");
    var freeze = document.getElementById("freeze");
    var play = document.getElementById("play");
    var slider = document.getElementById("slider-prog");
    var msgForm = document.getElementById("message-form");
    var fullStyle = document.getElementById("full-style");
    function freezeVid() {
        console.log('trying to freeze with '+firstFiring+' and '+wasPaused);
        if(firstFiring === true && wasPaused === false) {
            freeze.style.display = "block";
            play.style.display = "block";
            vid.pause();
        }
    }
    function playVid() {
        freeze.style.display = "none";
        play.style.display = "none";
        vid.play();
    }
    function miniClick() {
        mini.style.display = "none";
        full.style.display = "block";
        playVid()
    }
    function cancelClick() {
        if(msgForm.style.display != 'none') {
            closeMsgForm();
        }
        else {
            freezeVid();
            mini.style.display = "block";
            full.style.display = "none";
        }        
    }
    function videoClick() {
        if(vid.paused) {
            playVid();
        } else {
            freezeVid();
        }
    }
    function practicallyEnded() {
        return vid.currentTime/vid.duration>0.9999;
    }
    function callPhone() {
        window.open("tel:+1800229933");
    }
    function openMsgForm() {
        freezeVid();
        msgForm.style.display = 'block';
        full.style.border='0.5em solid #000000';
    }
    function closeMsgForm() {
        msgForm.style.display = 'none';
        full.style.border = 'none'
    }
    vid.onended = freezeVid;
    var wasPaused = false;
    var firstFiring = true;
    function sliderClick() {
        console.log('sliderKRIK')
        if(vid.paused && firstFiring) {
            wasPaused = true;
        }
        firstFiring = false;
        vid.pause();
        vid.currentTime = vid.duration*slider.value/slider.max;
    }
    function sliderRelease() {
        if(practicallyEnded()) {
            firstFiring = true;
            wasPaused = false;
            freezeVid();
        } else if(!wasPaused) {
            playVid();
        }
        firstFiring = true;
        wasPaused = false;
    }
    slider.oninput = sliderClick;
    slider.onmouseup = sliderRelease;
        setInterval(function progressUpdates() {
        slider.value = ((vid.currentTime / vid.duration) * slider.max);
    }, 30);
</script>
